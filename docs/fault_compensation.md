---
layout: page
title: 维护与故障
permalink: /维护与故障
nav_order: 12
---

# 维护与故障

当平台遇到维护、故障时的解决办法，以及用户如何才能尽可能得减少这些因素带来的损失。

## 维护

维护分为两种：**停机维护** 和 **网络维护**。

### 停机维护

停机维护即所有的机器全部下线关机进行维护。我们不定期会对平台做停机维护，所有维护操作均会**提前至少 24 小时**做全平台通知（通知方式包括控制台弹窗，用户群公告），通知内容包括 **下线时间** 和 **预计恢复时间**。一般来说，维护的总时长不会超过 24 小时。

补偿：

| 租用类型 | 赔偿规则 |
| ------ | ------ |
| 长租实例 | 如果用户的长租实例服务时间与维护时间有重叠，平台会延长这类实例的到期时间，延长的时间等于维护时间以天为单位向上取整。例如如果维护一共进行了 26 个小时，那么会对所有维护期间受影响的长租实例延长 2 天的租用时间。|
| 短租实例 | 短租实例在平台离线期间不会进行扣费，无需做额外补偿。|

### 网络维护

不影响实例运行的短暂维护称为网络维护。网络维护根据维护内容可能会导致用户无法进入工作区，但不会影响机器的运行状态，单台机器的维护时间一天内累计不超过 30 分钟，如果超过 30 分钟则视作故障，按故障的规则处理。这类维护我们不做补偿。

## 故障

故障也分为 **机器故障** 和 **网络故障**。

### 机器故障

机器意外导致用户容器重启为机器故障，容器重启会导致工作区恢复到初始状态（类似重置实例功能）。机器故障赔偿统一公式为：

```
赔偿代金券 = 不可用小时数 * 实例单价 * 2
```

例如小红租了一台单价为 2 块的 2080 Ti 机器（不分长短租），然后她租用的机器在其使用期间发生故障，不可用时间为 4 小时，她将会获得 **16 元代金券** 的赔偿。

### 网络故障

一天内累计超过 30 分钟用户因为平台网络问题无法访问工作区称为网络故障，网络故障的赔偿方式与机器故障相同。

## 最小化故障带来的影响

将训练的模型、日志、可视化文件等全部写到 `work` 目录中来做持久化。如果你在训练过程中有大量文件需要频繁写入磁盘而影响训练速度，建议：

1. 异步 IO 操作。可以考虑将所有 IO 操作交给单独的线程/进程来执行，这需要一些多线程编程基础。
2. 把所有文件写入 work 之外的目录，然后用写一个简单的脚本来定时将重要的文件复制到 work 目录内。
3. 保证训练程序是「可恢复的」。
